**Решение проблем совместимости с помощью Application Compatibility Toolkit (ACT): Установка и настройка**

Application Compatibility Toolkit (ACT) — это набор инструментов от Microsoft, предназначенный для выявления, устранения и управления проблемами совместимости приложений с различными версиями Windows .

### Установка ACT

Важно понимать, что в современных версиях Windows (10 и 11) ACT больше не поставляется как отдельный пакет. Теперь он является частью **Windows Assessment and Deployment Kit (ADK)** .

Чтобы установить ACT, выполните следующие шаги:

1.  **Скачайте Windows ADK.** Перейдите на официальную страницу загрузки Windows ADK на сайте Microsoft.
2.  **Запустите установщик ADK.** При запуске установщика вам будет предложено выбрать компоненты для установки.
3.  **Выберите компонент "Application Compatibility Tools".** Убедитесь, что этот компонент отмечен для установки. Именно он содержит все необходимые утилиты ACT, включая Compatibility Administrator .
4.  **Завершите установку.** После завершения процесса установки инструменты ACT будут доступны на вашем компьютере.

### Настройка и создание "Shim"

Основной механизм ACT для решения проблем совместимости — это создание и применение **Shim** (исправлений совместимости). Shim — это небольшой программный модуль, который перехватывает вызовы API между приложением и операционной системой, изменяя их таким образом, чтобы приложение работало корректно .

Для создания Shim используется утилита **Compatibility Administrator**:

1.  **Запустите Compatibility Administrator.** После установки ADK вы найдете эту утилиту в меню "Пуск" (обычно в папке Windows Kits).
2.  **Создайте новую базу данных.** В главном меню выберите `File` -> `New` -> `Database`. Сохраните файл с расширением `.sdb`.
3.  **Добавьте новое исправление.** В дереве слева выберите `Application Fixes` и нажмите `New` -> `Application Fix`.
4.  **Укажите параметры приложения.** В появившемся мастере укажите:
    *   Название приложения.
    *   Имя производителя.
    *   Путь к исполняемому файлу (.exe) проблемного приложения .
5.  **Выберите проблемы совместимости.** На следующем шаге вы увидите список известных проблем совместимости (например, "Windows 7", "Reduced privileges", "RunAsInvoker" и т.д.). Отметьте те, которые, по вашему мнению, решают вашу проблему .
6.  **Сохраните базу данных.** После настройки всех параметров сохраните вашу базу данных Shim.
7.  **Установите базу данных.** Чтобы применить исправление, нужно установить базу данных на целевой компьютер. Это можно сделать двумя способами:
    *   **Вручную:** Запустите командную строку от имени администратора и выполните команду: `sdbinst "C:\путь\к\вашей\базе.sdb"`.
    *   **Через групповые политики:** Для корпоративной среды базу данных можно развернуть на множество компьютеров с помощью объектов групповой политики (GPO).

После установки базы данных Shim будет автоматически применяться каждый раз при запуске указанного приложения, решая проблему совместимости .